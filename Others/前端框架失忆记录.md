# 前端框架失忆记录 -- 零散点 

### easyUi

常用功能：
* `$.message.alert()`  参数有：title , contentTxt , 'info/error/warning' 
* `$.messager.progress({title:'请稍后',msg:'页面加载中...'});`  加载进度loding  
another way
```javascript
function ajaxLoading(){   
    $("<div class=\"datagrid-mask\"></div>").css({display:"block",width:"100%",height:$(window).height()}).appendTo("body");   
    $("<div class=\"datagrid-mask-msg\"></div>").html("正在处理，请稍候。。。").appendTo("body").css({display:"block",left:($(document.body).outerWidth(true) - 190) / 2,top:($(window).height() - 45) / 2});   
 }   
 function ajaxLoadEnd(){   
     $(".datagrid-mask").remove();   
     $(".datagrid-mask-msg").remove();               
} 
```
* `var a = $('#tabs').tabs('getTab','tabTitle'); a.panel('refresh');`  面板刷新：先获取tab再刷新tab对应的面板
* `var tab = $('#tabs').tabs('getSelected');  $('#tabs').tabs('getTabIndex',tab);`  先获取选中的标签，再获取到它的标签索引
* `var tab = $('#tabs').tabs('select',title)`  选中某一个标签
* `var tab = $('#tabs').tabs('exist',title);`  判断是否存在该标签 
*  新增标签：
``` javascript
$('#tabs').tabs('add',{
  title:'',
  content:'',
  closable:true
})
```

### jQuery
常见api:
* 表单中的参数提交序列化 `$('#form').serializeArray()` 或 `$('#form').serialize()`  
通过遍历数组，新增一个对象赋值，再使用异步发送参数:
  ```javascript
  $.each(arr,function(item){
     obj[item.name] = item.value;
  })
  ```
* 通过元素属性获取DOM元素  `$("td[name='']")[index]` 
* 从`$('#id').attr()`获取属性为boolean之后，得到的是一个字符串。此时，if("false")为true，因为condition是非控制，因此需要if(xx == 'true')
* 使用`$.ajax({})`传参数时，如果`data{ id : xx }`，xx为null，此时没有向请求发送字段和字段值。必须显式赋值null，才能传送。 
* 在元素标签定义了自定义属性，可以通过以下方式获取  
```jquery
$("#aa").attr('data-href');
//或
$("#aa").data('href');
```
### 原生JavaScript
* 表单重置 `document.getElementById().reset()` //对表单有效
* `for (.. in obj)` 不能对数组进行遍历，否则会读取原型属性，多遍历一个项，即length + 1; 建议用for(x of arr)
* 轮询可以通过setTimeout以及setInterval来发送请求

### 兼容性问题
* `for (.. in obj)` 不能对数组使用，否则会读取原型属性，多遍历一个项，即length + 1，PC浏览器不会出现+1，但IOS或者安卓等不支持ES6的可能出现问题

* `window.onpopstate`    
  每当活动历史记录条目在同一文档的两个历史记录条目之间发生变化时，就会将事件分派到窗口。  
  浏览器操作历史记录的前进/后退触发或者history.back();  
  > 可能在当前页面触发，触发条件应该为瞄点引起的页面跳转
  ```javascript
  window.onpopstate=function(event){
    event.state  //返回pageId,id号,url
  }
  ```
  > 浏览器兼容性问题（IOS版的微信，是会立即触发popstate事件）：监听微信的返回按钮，存在这样一个问题："当页面被加载的时候，popstate会立即被触发"。而根据官方文档对popstate的描述，只要访问历史记录就会触发popstate。而传统的History中访问页面和生产历史记录是同时的。
  由于我在项目前，先是调用监听该window的onpopstate事件的方法，再调用请求接口获取数据的方法，导致数据在还没加载完毕时获取不了，报错undefined；
  ```javascript
  //错误演示Vue
  function aaa(){
    window.onpopstate=function(event){
      if(event.state){   //正常初始化时不会被触发，除非点击浏览器操作和IOS的
          document.title = vm.a;   //vm.a为undefined，因为实例数据尚未加载完毕，且该方法声明比请求接口数据更早
          console.log(vm.a);    //当触发后会响应式读取实例数据
       }
    }
  }
  function bbb(){
    $.ajax({})  //将this.a = data.xxx;
  }
  
  //避免以上情况，正确应该放在success成功后才去监听该事件。
  ```

* display:inline-block
由于在IE6和IE7中，块节点元素不能正确识别此样式，那么对应的处理操作是：再写一个同样的节点样式，来进行兼容性设置。  
代码如下：
```css
//必须分开两个css才生效
div.myNode {display: inline-block;}
div.myNode {
    *display: inline;   // IE6、IE7识别
    _zoom: 1;           // IE6识别
}
```

### freeMarker语法
```
<#if></#if>
<#list xx as x>
<#assign aa="" >  // 注册页面同步变量
${}
//判空
${xx!}  ${xx!''}
<#if aa??>
//过滤器
<#if !numbers?seq_contain(number)>  //判断是否包含
<#if arr?size gt 0>

//转换同步数据为json
var a = '${jsonTool.toJSON(profile)}')
```


### Beetl语法
<%if( )%>


### 缓存问题
为了避免读取缓存中的静态文件，采用添加时间戳进行重新加载。

### 请求错误原因
* 404 不用说了吧，就是找不到页面，url写错了吧
* 400 请求参数有误，检查参数字段
* 403 可能需要进行权限验证，传送crsf
* 500 交给后台解决

### 解决http与https协议问题
访问chrome://net-internal/#hsts
删除对应想访问的目标域名

### SUI Mobile下的链接跳转报错
描述：将跳转链接转换为异步请求结果，出现cancel错误描述  
解决方法：
1. 在最外层div中添加类名（disable-router）;  
2. 监听ajaxError,$(document).on('ajaxError',function(e,xhr,setting){}),当错误码xhr.status = 0（cancel）就不做处理  

### 全局设置的请求报错
如果使用$.when.done()会导致global 全局设置失效，几遍在请求的时候配置global为true

### 项目中IFrame的各种问题
1. IOS系统点击iframe下的链接无响应
2. 读取子页面时元素的繁琐，由于做了跨域限制因此不好实施（若同级域名，可以使用document.domain解决）
3. 自适应的页面内容难以适配移动端（通常固定一个高度然后进行滚动，scrolling=yes overflow="scroll"）  
后来1和3问题改用了div弹层实现，2问题使用传送数据替代传送元素对象

* 其中解决IOS的iframe滚动失效问题的方案：
.iframe-div{
height:15rem;
-webkit-overflow-scrolling:touch;
overflow-y:scroll;
}
.iframe-div iframe{width:100%;height:15rem}

### IOS与Android系统设置字体时差异
在<span><a></a></span>给标签设置了样式，父标签使用字体粗度700，子标签用500，然而IOS显示一样粗的字体，后来用!important解决了a标签的字体粗度。（怀疑原因：1、系统字体不一致，但在body应该有设全局字体；2、a标签的字体粗度样式在ios是继承或者覆盖无效？）
